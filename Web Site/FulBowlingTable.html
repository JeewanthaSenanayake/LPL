<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <meta name="copyright" content="MACode ID, https://www.macodeid.com/">
  
  <title>LPL Bowling Rankings</title>
  
  <link rel="shortcut icon" type="image/ico" href=" assets/favicon.ico">
  
  <link rel="stylesheet" type="text/css" href=" assets/css/themify-icons.css">
  
  <link rel="stylesheet" type="text/css" href=" assets/css/bootstrap.css">

  <link rel="stylesheet" type="text/css" href=" assets/vendor/animate/animate.css">
  
  <link rel="stylesheet" type="text/css" href=" assets/vendor/owl-carousel/owl.carousel.css">
  
  <link rel="stylesheet" type="text/css" href=" assets/vendor/perfect-scrollbar/css/perfect-scrollbar.css">
  
  <link rel="stylesheet" type="text/css" href=" assets/vendor/nice-select/css/nice-select.css">
  
  <link rel="stylesheet" type="text/css" href=" assets/vendor/fancybox/css/jquery.fancybox.min.css">
  
  <link rel="stylesheet" type="text/css" href=" assets/css/virtual.css">
  
  <link rel="stylesheet" type="text/css" href=" assets/css/minibar.virtual.css">
</head>
<body class="theme-red">
  
  <!-- Back to top button -->
  <div class="btn-back_to_top">
    <span class="ti-arrow-up"></span>
  </div>
  
<!-- Batting-->

  <div class="container">
    <h1 class="text-center fw-normal wow fadeIn">LPL Bowling Rankings</h1>
    <center>
      <img id="bowlingtable_img" src="assets/img/loadingimg.gif" alt="loading" height="120" width="120">
    <b><p>#1 Bowler</p></b>  
    <p id="bowlingtable"><img src="assets/img/loading.gif" alt="loading" height="50" width="50"></p>
  </center>
  </div>

  
  <!-- Mini bar -->
  <div class="minibar">
    <div class="header">
      <div class="brand">
        
      </div>
    </div>
    <div class="content">
      <ul class="main-menu">
        <li class="menu-item active">
          <a href="index.html" class="menu-link">
            <span class="icon ti-arrow-left"></span>
            <span class="caption">Back</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="footer">
      <div class="social-menu">      
      </div>
    </div>
  </div>
  
<!-- Footer -->
<div class="vg-footer">
  <!-- <h1 class="text-center">Virtual Folio</h1> -->
  <div class="container">
    <div class="row justify-content-center mt-3">
      <div class="col-12">
        <p class="text-center mb-0 mt-4">Copyright &copy;2022. All right reserved</p>
        <p class="text-center mb-0 mt-4">Jeewantha Senanayake</p>
        <!-- <p class="text-center mb-0 mt-4">jeewanthamsenanayake@gmail.com</p> -->
        <p class="text-center mb-0 mt-4"><a href="mailto:<jeewanthamsenanayake@gmail.com>jeewanthamsenanayake@gmail.com?subject=Feedback About LPL Player Ranking System">Send Your Feedback</a></p>
        <center><a href="https://www.facebook.com/robotpancha"><br><img src="assets/img/facebook.png" alt="Girl in a jacket" width="30" height="30"></a></center> 
      </div>
    </div>
  </div>
</div> <!-- End footer -->
  
  <script src=" assets/js/jquery-3.5.1.min.js"></script>
  
  <script src=" assets/js/bootstrap.bundle.min.js"></script>
  
  <script src=" assets/vendor/owl-carousel/owl.carousel.min.js"></script>
  
  <script src=" assets/vendor/perfect-scrollbar/js/perfect-scrollbar.js"></script>
  
  <script src=" assets/vendor/isotope/isotope.pkgd.min.js"></script>
  
  <script src=" assets/vendor/nice-select/js/jquery.nice-select.min.js"></script>
  
  <script src=" assets/vendor/fancybox/js/jquery.fancybox.min.js"></script>

  <!-- <script src=" assets/vendor/wow/wow.min.js"></script> -->

  <script src=" assets/vendor/animateNumber/jquery.animateNumber.min.js"></script>

  <script src=" assets/vendor/waypoints/jquery.waypoints.min.js"></script>

  <script src=" assets/js/google-maps.js"></script>

  <script src=" assets/js/minibar-virtual.js"></script>

  <!-- <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAIA_zqjFMsJM_sxP9-6Pde5vVCTyJmUHM&callback=initMap"></script> -->

  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-analytics.js";
    // import { getFirestore , setDoc, doc, collection, addDoc, getDoc } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-firestore.js";
    import { getFirestore, collection, getDocs, setDoc, doc } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-firestore.js";
    import { getStorage, ref, getMetadata, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-storage.js";

    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "####################################",
      authDomain: "####################################",
      projectId: "####################################",
      storageBucket: "####################################",
      messagingSenderId: "####################################",
      appId: "####################################",
      measurementId: "####################################"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

    const db = getFirestore(app);
  
    var tow_dimentional_array_bowling = [];

    var bowlingid = 1;

    var tableBowling = '<div class="table"><table><tr><th>POS</th><th>Player</th><th>Rating</th>';
   
    var oneBowler;
   

    const querySnapshot = await getDocs(collection(db, "ratings"));
    querySnapshot.forEach((docData) => {
      tow_dimentional_array_bowling.push([docData.id, docData.data()["bowlling"]]);
    });

    tow_dimentional_array_bowling.sort(function (a, b) {
      return b[1] - a[1];
    })


    tow_dimentional_array_bowling.forEach((data) => {

      if(bowlingid == 1){
        oneBowler = data[0];
      }

      if (data[1]>0) {
        tableBowling = tableBowling + '<tr><td>' + bowlingid + '</td><td>' + data[0] + '</td><td>' + data[1] + '</td></tr>';
      }
      bowlingid = bowlingid + 1;
    });

    tableBowling = tableBowling + '</table></div>';


    document.getElementById("bowlingtable").innerHTML = tableBowling;
  


    // player image
    const storage = getStorage();

    //for bowling
    getDownloadURL(ref(storage, oneBowler + '.jpg'))
      .then((url) => {
        // `url` is the download URL for 'images/stars.jpg'

        // This can be downloaded directly:
        const xhr = new XMLHttpRequest();
        xhr.responseType = 'blob';
        xhr.onload = (event) => {
          const blob = xhr.response;
        };
        xhr.open('GET', url);
        xhr.send();
        // Or inserted into an <img> element
        const img = document.getElementById('bowlingtable_img');
        img.setAttribute('src', url);
      })
      .catch((error) => {
        // Handle any errors
      });

  </script>

</body>
</html>